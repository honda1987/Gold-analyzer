<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèÜ Gold Realtime Analyzer Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .controls select, .controls button {
            padding: 12px 20px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .controls select {
            background: white;
        }
        
        .controls button {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        
        .controls button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .controls button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .status {
            flex: 1;
            text-align: right;
            color: #666;
            font-size: 14px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .price-display {
            font-size: 3em;
            font-weight: bold;
            color: #333;
            margin: 20px 0;
        }
        
        .change {
            font-size: 1.5em;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 8px;
            display: inline-block;
        }
        
        .change.positive {
            color: #10b981;
            background: #d1fae5;
        }
        
        .change.negative {
            color: #ef4444;
            background: #fee2e2;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .metric:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            color: #666;
            font-weight: 500;
        }
        
        .metric-value {
            font-weight: bold;
            color: #333;
        }
        
        .indicator {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .indicator.bullish {
            background: #d1fae5;
            border-left: 4px solid #10b981;
        }
        
        .indicator.bearish {
            background: #fee2e2;
            border-left: 4px solid #ef4444;
        }
        
        .indicator.neutral {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 18px;
        }
        
        .thai-gold {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .thai-price {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .thai-price-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .thai-price-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }
        
        .order-book {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        
        .order-side {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
        }
        
        .order-side h3 {
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .order-side.bids h3 {
            color: #10b981;
        }
        
        .order-side.asks h3 {
            color: #ef4444;
        }
        
        .order-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            padding: 8px;
            font-size: 14px;
            border-bottom: 1px solid #e5e7eb;
            position: relative;
        }
        
        .order-row:last-child {
            border-bottom: none;
        }
        
        .order-header {
            font-weight: bold;
            color: #666;
            background: #f1f5f9;
            border-radius: 4px;
            margin-bottom: 5px;
        }
        
        .order-price {
            font-weight: bold;
        }
        
        .bids .order-price {
            color: #10b981;
        }
        
        .asks .order-price {
            color: #ef4444;
        }
        
        .order-bar {
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
            opacity: 0.1;
            z-index: 0;
        }
        
        .bids .order-bar {
            background: #10b981;
        }
        
        .asks .order-bar {
            background: #ef4444;
        }
        
        .order-row > * {
            position: relative;
            z-index: 1;
        }
        
        .spread-info {
            background: #fef3c7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
        
        .spread-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .spread-value {
            font-size: 20px;
            font-weight: bold;
            color: #f59e0b;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .updating {
            animation: pulse 1.5s infinite;
        }

        .github-link {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            text-decoration: none;
            color: #333;
            font-weight: bold;
            transition: all 0.3s;
        }

        .github-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <a href="https://github.com/yourusername/gold-analyzer" class="github-link" target="_blank">
        ‚≠ê GitHub
    </a>

    <div class="container">
        <div class="header">
            <h1>üèÜ Gold Realtime Analyzer Pro</h1>
            <p>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå‡∏û‡∏£‡πâ‡∏≠‡∏° Order Book</p>
        </div>
        
        <div class="controls">
            <select id="symbolSelect">
                <option value="XAUUSD">Gold/USD (XAU/USD)</option>
                <option value="BTCUSD">Bitcoin/USD</option>
                <option value="ETHUSD">Ethereum/USD</option>
            </select>
            
            <select id="intervalSelect">
                <option value="1m">1 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
                <option value="5m" selected>5 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
                <option value="15m">15 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
                <option value="1h">1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</option>
            </select>
            
            <button id="refreshBtn" onclick="fetchAllData()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
            <button id="autoRefreshBtn" onclick="toggleAutoRefresh()">‚ñ∂Ô∏è Auto Refresh</button>
            
            <div class="status" id="status">
                <div>‚è∞ <span id="lastUpdate">-</span></div>
            </div>
        </div>
        
        <div class="dashboard">
            <div class="card">
                <h2>üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h2>
                <div id="priceCard" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            </div>
            
            <div class="card">
                <h2>üìä ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</h2>
                <div id="changeCard" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            </div>
            
            <div class="card">
                <h2>üìà Technical Indicators</h2>
                <div id="indicatorCard" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            </div>
            
            <div class="card">
                <h2>üéØ ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</h2>
                <div id="trendCard" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            </div>
        </div>

        <div class="card">
            <h2>üìñ Order Book (‡∏™‡∏°‡∏°‡∏∏‡∏ï‡∏¥)</h2>
            <div id="orderBookCard" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
        </div>
        
        <div class="card">
            <h2>üìâ ‡∏Å‡∏£‡∏≤‡∏ü‡∏£‡∏≤‡∏Ñ‡∏≤</h2>
            <div class="chart-container">
                <canvas id="priceChart"></canvas>
            </div>
        </div>
        
        <div class="card">
            <h2>üáπüá≠ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÑ‡∏ó‡∏¢</h2>
            <div id="thaiGoldCard" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
        </div>
    </div>

    <script>
        let autoRefreshInterval = null;
        let priceChart = null;
        let currentPrice = 0;
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì RSI
        function calculateRSI(prices, period = 14) {
            if (prices.length < period) return 50;
            
            let gains = 0;
            let losses = 0;
            
            for (let i = prices.length - period; i < prices.length; i++) {
                const change = prices[i] - prices[i - 1];
                if (change > 0) gains += change;
                else losses += Math.abs(change);
            }
            
            const avgGain = gains / period;
            const avgLoss = losses / period;
            
            if (avgLoss === 0) return 100;
            const rs = avgGain / avgLoss;
            return 100 - (100 / (1 + rs));
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SMA
        function calculateSMA(prices, period) {
            if (prices.length < period) return prices[prices.length - 1];
            const slice = prices.slice(-period);
            return slice.reduce((a, b) => a + b, 0) / period;
        }

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á Order Book ‡∏™‡∏°‡∏°‡∏∏‡∏ï‡∏¥
        function generateOrderBook(basePrice) {
            const bids = [];
            const asks = [];
            const levels = 10;
            const spread = basePrice * 0.0001; // 0.01% spread
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á bids
            for (let i = 0; i < levels; i++) {
                const price = basePrice - spread - (i * spread * 0.5);
                const size = Math.random() * 10 + 1;
                const total = price * size;
                bids.push({ price, size, total });
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á asks
            for (let i = 0; i < levels; i++) {
                const price = basePrice + spread + (i * spread * 0.5);
                const size = Math.random() * 10 + 1;
                const total = price * size;
                asks.push({ price, size, total });
            }
            
            return { bids, asks, spread: asks[0].price - bids[0].price };
        }

        // ‡πÅ‡∏™‡∏î‡∏á Order Book
        function updateOrderBook(basePrice) {
            const { bids, asks, spread } = generateOrderBook(basePrice);
            const maxBidTotal = Math.max(...bids.map(b => b.total));
            const maxAskTotal = Math.max(...asks.map(a => a.total));
            
            let html = `
                <div class="spread-info">
                    <div class="spread-label">Spread</div>
                    <div class="spread-value">$${spread.toFixed(2)}</div>
                </div>
                <div class="order-book">
                    <div class="order-side bids">
                        <h3>üü¢ Bids (‡∏ã‡∏∑‡πâ‡∏≠)</h3>
                        <div class="order-row order-header">
                            <span>‡∏£‡∏≤‡∏Ñ‡∏≤</span>
                            <span>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì</span>
                            <span>‡∏£‡∏ß‡∏°</span>
                        </div>
            `;
            
            bids.forEach(bid => {
                const barWidth = (bid.total / maxBidTotal) * 100;
                html += `
                    <div class="order-row">
                        <div class="order-bar" style="width: ${barWidth}%"></div>
                        <span class="order-price">$${bid.price.toFixed(2)}</span>
                        <span>${bid.size.toFixed(3)}</span>
                        <span>$${bid.total.toFixed(2)}</span>
                    </div>
                `;
            });
            
            html += `
                    </div>
                    <div class="order-side asks">
                        <h3>üî¥ Asks (‡∏Ç‡∏≤‡∏¢)</h3>
                        <div class="order-row order-header">
                            <span>‡∏£‡∏≤‡∏Ñ‡∏≤</span>
                            <span>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì</span>
                            <span>‡∏£‡∏ß‡∏°</span>
                        </div>
            `;
            
            asks.forEach(ask => {
                const barWidth = (ask.total / maxAskTotal) * 100;
                html += `
                    <div class="order-row">
                        <div class="order-bar" style="width: ${barWidth}%"></div>
                        <span class="order-price">$${ask.price.toFixed(2)}</span>
                        <span>${ask.size.toFixed(3)}</span>
                        <span>$${ask.total.toFixed(2)}</span>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
            
            document.getElementById('orderBookCard').innerHTML = html;
        }
        
        // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å CoinGecko (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏°‡∏∏‡∏ï‡∏¥)
        async function fetchGoldData() {
            const symbol = document.getElementById('symbolSelect').value;
            const refreshBtn = document.getElementById('refreshBtn');
            
            refreshBtn.disabled = true;
            refreshBtn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
            
            try {
                // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö demo ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏°‡∏∏‡∏ï‡∏¥
                const basePrice = symbol === 'XAUUSD' ? 2650 : 
                                 symbol === 'BTCUSD' ? 67500 : 3200;
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏°‡∏°‡∏∏‡∏ï‡∏¥
                const prices = [];
                const volumes = [];
                let price = basePrice;
                
                for (let i = 0; i < 50; i++) {
                    price = price + (Math.random() - 0.5) * (basePrice * 0.002);
                    prices.push(price);
                    volumes.push(Math.random() * 1000 + 500);
                }
                
                currentPrice = prices[prices.length - 1];
                const openPrice = prices[0];
                const highPrice = Math.max(...prices);
                const lowPrice = Math.min(...prices);
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì indicators
                const rsi = calculateRSI(prices);
                const sma20 = calculateSMA(prices, Math.min(20, prices.length));
                const avgVolume = volumes.reduce((a, b) => a + b, 0) / volumes.length;
                const currentVolume = volumes[volumes.length - 1];
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
                const dayChange = currentPrice - openPrice;
                const dayChangePct = (dayChange / openPrice) * 100;
                const fromHighPct = ((currentPrice - highPrice) / highPrice) * 100;
                const fromLowPct = ((currentPrice - lowPrice) / lowPrice) * 100;
                const aboveSMA20Pct = ((currentPrice - sma20) / sma20) * 100;
                const volumeChangePct = ((currentVolume - avgVolume) / avgVolume) * 100;
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó UI
                updatePriceCard(symbol, currentPrice, dayChange, dayChangePct);
                updateChangeCard(openPrice, highPrice, lowPrice, fromHighPct, fromLowPct);
                updateIndicatorCard(rsi, aboveSMA20Pct, volumeChangePct);
                updateTrendCard(dayChangePct, aboveSMA20Pct, rsi, volumeChangePct);
                updateChart(prices);
                updateOrderBook(currentPrice);
                
                document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('th-TH');
                
            } catch (error) {
                console.error('Error:', error);
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
            }
            
            refreshBtn.disabled = false;
            refreshBtn.textContent = 'üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä';
        }
        
        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤
        function updatePriceCard(symbol, price, change, changePct) {
            const changeClass = change >= 0 ? 'positive' : 'negative';
            const changeSymbol = change >= 0 ? 'üü¢ +' : 'üî¥ ';
            
            document.getElementById('priceCard').innerHTML = `
                <div class="price-display">$${price.toFixed(2)}</div>
                <div class="change ${changeClass}">
                    ${changeSymbol}${Math.abs(change).toFixed(2)} (${changePct.toFixed(2)}%)
                </div>
            `;
        }
        
        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
        function updateChangeCard(open, high, low, fromHighPct, fromLowPct) {
            document.getElementById('changeCard').innerHTML = `
                <div class="metric">
                    <span class="metric-label">‡πÄ‡∏õ‡∏¥‡∏î</span>
                    <span class="metric-value">$${open.toFixed(2)}</span>
                </div>
                <div class="metric">
                    <span class="metric-label">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>
                    <span class="metric-value">$${high.toFixed(2)}</span>
                </div>
                <div class="metric">
                    <span class="metric-label">‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î</span>
                    <span class="metric-value">$${low.toFixed(2)}</span>
                </div>
                <div class="metric">
                    <span class="metric-label">‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>
                    <span class="metric-value">${fromHighPct.toFixed(2)}%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î</span>
                    <span class="metric-value">+${fromLowPct.toFixed(2)}%</span>
                </div>
            `;
        }
        
        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πå‡∏î indicators
        function updateIndicatorCard(rsi, aboveSMA20Pct, volumeChangePct) {
            let rsiStatus = 'neutral';
            let rsiText = 'Neutral';
            if (rsi > 70) {
                rsiStatus = 'bearish';
                rsiText = 'Overbought';
            } else if (rsi < 30) {
                rsiStatus = 'bullish';
                rsiText = 'Oversold';
            }
            
            document.getElementById('indicatorCard').innerHTML = `
                <div class="indicator ${rsiStatus}">
                    <span>RSI (14)</span>
                    <span><strong>${rsi.toFixed(2)}</strong> - ${rsiText}</span>
                </div>
                <div class="metric">
                    <span class="metric-label">‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö SMA20</span>
                    <span class="metric-value">${aboveSMA20Pct >= 0 ? '+' : ''}${aboveSMA20Pct.toFixed(2)}%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Volume vs ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</span>
                    <span class="metric-value">${volumeChangePct >= 0 ? '+' : ''}${volumeChangePct.toFixed(2)}%</span>
                </div>
            `;
        }
        
        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°
        function updateTrendCard(dayChangePct, aboveSMA20Pct, rsi, volumeChangePct) {
            let score = 0;
            let signals = [];
            
            if (dayChangePct > 0) {
                score++;
                signals.push('‚úÖ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å');
            } else {
                signals.push('‚ùå ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏ö');
            }
            
            if (aboveSMA20Pct > 0) {
                score++;
                signals.push('‚úÖ ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ SMA20');
            } else {
                signals.push('‚ùå ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ SMA20');
            }
            
            if (30 < rsi && rsi < 70) {
                score++;
                signals.push('‚úÖ RSI ‡∏õ‡∏Å‡∏ï‡∏¥');
            } else if (rsi < 30) {
                signals.push('üü¢ RSI Oversold');
            } else {
                signals.push('üî¥ RSI Overbought');
            }
            
            if (volumeChangePct > 0) {
                score++;
                signals.push('‚úÖ Volume ‡∏™‡∏π‡∏á');
            } else {
                signals.push('‚ùå Volume ‡∏ï‡πà‡∏≥');
            }
            
            let trendClass = 'neutral';
            let trendText = 'üü° Neutral';
            if (score >= 3) {
                trendClass = 'bullish';
                trendText = 'üü¢ Bullish';
            } else if (score <= 1) {
                trendClass = 'bearish';
                trendText = 'üî¥ Bearish';
            }
            
            document.getElementById('trendCard').innerHTML = `
                <div class="indicator ${trendClass}" style="font-size: 1.2em; margin-bottom: 20px;">
                    <span>‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</span>
                    <span><strong>${trendText}</strong></span>
                </div>
                <div class="metric">
                    <span class="metric-label">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>
                    <span class="metric-value">${score}/4</span>
                </div>
                ${signals.map(s => `<div class="metric"><span>${s}</span></div>`).join('')}
            `;
        }
        
        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏£‡∏≤‡∏ü
        function updateChart(prices) {
            const labels = prices.map((_, i) => i);
            
            const ctx = document.getElementById('priceChart').getContext('2d');
            
            if (priceChart) {
                priceChart.destroy();
            }
            
            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '‡∏£‡∏≤‡∏Ñ‡∏≤ ($)',
                        data: prices,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    }
                }
            });
        }
        
        // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≠‡∏á‡πÑ‡∏ó‡∏¢
        async function fetchThaiGold() {
            try {
                const response = await fetch('https://api.chnwt.dev/thai-gold-api/latest');
                const data = await response.json();
                
                if (data.response && data.response.price) {
                    const buy = data.response.price.gold_bar.buy;
                    const sell = data.response.price.gold_bar.sell;
                    const date = data.response.date;
                    
                    document.getElementById('thaiGoldCard').innerHTML = `
                        <div style="text-align: center; color: #666; margin-bottom: 15px;">
                            ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: ${date}
                        </div>
                        <div class="thai-gold">
                            <div class="thai-price">
                                <div class="thai-price-label">üí∞ ‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠</div>
                                <div class="thai-price-value">‡∏ø${buy.toLocaleString()}</div>
                            </div>
                            <div class="thai-price">
                                <div class="thai-price-label">üí∞ ‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å</div>
                                <div class="thai-price-value">‡∏ø${sell.toLocaleString()}</div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 15px; color: #666;">
                            Spread: ‡∏ø${(sell - buy).toLocaleString()}
                        </div>
                    `;
                }
            } catch (error) {
                document.getElementById('thaiGoldCard').innerHTML = `
                    <div style="text-align: center; color: #999;">
                        ‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≠‡∏á‡πÑ‡∏ó‡∏¢‡πÑ‡∏î‡πâ
                    </div>
                `;
            }
        }

        // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        async function fetchAllData() {
            await fetchGoldData();
            await fetchThaiGold();
        }
        
        // Toggle auto refresh
        function toggleAutoRefresh() {
            const btn = document.getElementById('autoRefreshBtn');
            
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
                btn.textContent = '‚ñ∂Ô∏è Auto Refresh';
                btn.style.background = '#667eea';
            } else {
                const interval = document.getElementById('intervalSelect').value;
                const seconds = { '1m': 60, '5m': 300, '15m': 900, '1h': 3600 }[interval];
                
                autoRefreshInterval = setInterval(fetchAllData, seconds * 1000);
                btn.textContent = '‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î Auto';
                btn.style.background = '#ef4444';
                
                fetchAllData();
            }
        }
        
        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
        window.onload = () => {
            fetchAllData();
        };